{"version":3,"names":["React","PanResponder","StyleSheet","View","Animated","Easing","I18nManager","StarIcon","getStars","defaultColor","defaultAnimationConfig","easing","elastic","duration","scale","delay","StarRating","rating","maxStars","starSize","onChange","color","emptyColor","enableHalfStar","enableSwiping","onRatingStart","onRatingEnd","animationConfig","style","starStyle","testID","starFull","starHalf","starBorder","width","useRef","ref","isInteracting","setInteracting","useState","handleInteraction","useCallback","x","isRTL","current","newRating","Math","max","min","round","ceil","panResponder","useMemo","create","onStartShouldSetPanResponder","onStartShouldSetPanResponderCapture","onMoveShouldSetPanResponder","onMoveShouldSetPanResponderCapture","onPanResponderMove","e","nativeEvent","locationX","onPanResponderStart","onPanResponderEnd","setTimeout","styles","starRating","panHandlers","measure","_x","_y","w","_h","map","starType","i","AnimatedIcon","active","children","animatedSize","Value","useEffect","animation","timing","toValue","useNativeDriver","start","stop","star","transform","flexDirection","alignSelf","marginHorizontal"],"sources":["StarRating.tsx"],"sourcesContent":["import React from \"react\";\nimport {\n    PanResponder,\n    StyleSheet,\n    View,\n    StyleProp,\n    ViewStyle,\n    Animated,\n    Easing,\n    I18nManager,\n} from \"react-native\";\nimport StarIcon, { IconProps } from \"./StarIcon\";\nimport { getStars } from \"./utils\";\n\ntype AnimationConfig = {\n    easing?: (value: number) => number;\n    duration?: number;\n    delay?: number;\n    scale?: number;\n};\n\ntype StarRatingProps = {\n    rating: number;\n    onChange: (rating: number) => void;\n    minRating?: number;\n    color?: string;\n    emptyColor?: string;\n    maxStars?: number;\n    starSize?: number;\n    enableHalfStar?: boolean;\n    enableSwiping?: boolean;\n    onRatingStart?: () => void;\n    onRatingEnd?: () => void;\n    style?: StyleProp<ViewStyle>;\n    starStyle?: StyleProp<ViewStyle>;\n    animationConfig?: AnimationConfig;\n    testID?: string;\n    starFull?: React.FC<IconProps>;\n    starHalf?: React.FC<IconProps>;\n    starBorder?: React.FC<IconProps>;\n};\n\nconst defaultColor = \"#fdd835\";\nconst defaultAnimationConfig: Required<AnimationConfig> = {\n    easing: Easing.elastic(2),\n    duration: 300,\n    scale: 1.2,\n    delay: 300,\n};\n\nconst StarRating: React.FC<StarRatingProps> = ({\n    rating,\n    maxStars = 5,\n    starSize = 32,\n    onChange,\n    color = defaultColor,\n    emptyColor = color,\n    enableHalfStar = true,\n    enableSwiping = true,\n    onRatingStart,\n    onRatingEnd,\n    animationConfig = defaultAnimationConfig,\n    style,\n    starStyle,\n    testID,\n    starFull,\n    starHalf,\n    starBorder,\n}) => {\n    const width = React.useRef<number>();\n    const ref = React.useRef<View>(null);\n    const [isInteracting, setInteracting] = React.useState(false);\n\n    const handleInteraction = React.useCallback(\n        (x: number, isRTL = I18nManager.isRTL) => {\n            if (width.current) {\n                if (isRTL) {\n                    handleInteraction(width.current - x, false);\n                    return;\n                }\n                const newRating = Math.max(\n                    0,\n                    Math.min(\n                        Math.round((x / width.current) * maxStars * 2 + 0.2) /\n                            2,\n                        maxStars\n                    )\n                );\n                if (newRating !== rating) {\n                    onChange(enableHalfStar ? newRating : Math.ceil(newRating));\n                }\n            }\n        },\n        [enableHalfStar, maxStars, onChange, rating]\n    );\n\n    const panResponder = React.useMemo(() => {\n        return PanResponder.create({\n            onStartShouldSetPanResponder: () => true,\n            onStartShouldSetPanResponderCapture: () => true,\n            onMoveShouldSetPanResponder: () => true,\n            onMoveShouldSetPanResponderCapture: () => true,\n            onPanResponderMove: e => {\n                if (enableSwiping) {\n                    handleInteraction(e.nativeEvent.locationX);\n                }\n            },\n            onPanResponderStart: e => {\n                onRatingStart?.();\n                handleInteraction(e.nativeEvent.locationX);\n                setInteracting(true);\n            },\n            onPanResponderEnd: () => {\n                onRatingEnd?.();\n                setTimeout(() => {\n                    setInteracting(false);\n                }, animationConfig.delay || defaultAnimationConfig.delay);\n            },\n        });\n    }, [\n        animationConfig.delay,\n        enableSwiping,\n        handleInteraction,\n        onRatingStart,\n        onRatingEnd,\n    ]);\n\n    return (\n        <View\n            ref={ref}\n            style={[styles.starRating, style]}\n            {...panResponder.panHandlers}\n            onLayout={() => {\n                if (ref.current) {\n                    ref.current.measure((_x, _y, w, _h) => (width.current = w));\n                }\n            }}\n            testID={testID}>\n            {getStars(rating, maxStars).map((starType, i) => {\n                return (\n                    <AnimatedIcon\n                        key={i}\n                        active={isInteracting && rating - i >= 0.5}\n                        animationConfig={animationConfig}\n                        style={starStyle}>\n                        <StarIcon\n                            type={starType}\n                            size={starSize}\n                            color={starType === \"empty\" ? emptyColor : color}\n                            starFull={starFull}\n                            starHalf={starHalf}\n                            starBorder={starBorder}\n                        />\n                    </AnimatedIcon>\n                );\n            })}\n        </View>\n    );\n};\n\ntype AnimatedIconProps = {\n    active: boolean;\n    children: React.ReactElement;\n    animationConfig: AnimationConfig;\n    style?: StyleProp<ViewStyle>;\n};\n\nconst AnimatedIcon: React.FC<AnimatedIconProps> = ({\n    active,\n    animationConfig,\n    children,\n    style,\n}) => {\n    const {\n        scale = defaultAnimationConfig.scale,\n        easing = defaultAnimationConfig.easing,\n        duration = defaultAnimationConfig.duration,\n    } = animationConfig;\n\n    const animatedSize = React.useRef(new Animated.Value(active ? scale : 1));\n\n    React.useEffect(() => {\n        const animation = Animated.timing(animatedSize.current, {\n            toValue: active ? scale : 1,\n            useNativeDriver: true,\n            easing,\n            duration,\n        });\n\n        animation.start();\n        return animation.stop;\n    }, [active, scale, easing, duration]);\n\n    return (\n        <Animated.View\n            pointerEvents=\"none\"\n            style={[\n                styles.star,\n                style,\n                {\n                    transform: [\n                        {\n                            scale: animatedSize.current,\n                        },\n                    ],\n                },\n            ]}>\n            {children}\n        </Animated.View>\n    );\n};\n\nconst styles = StyleSheet.create({\n    starRating: {\n        flexDirection: \"row\",\n        alignSelf: \"flex-start\",\n    },\n    star: {\n        marginHorizontal: 5,\n    },\n});\n\nexport default StarRating;\n"],"mappings":"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"}